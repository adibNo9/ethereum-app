{"ast":null,"code":"import '../../types/chain.js';\nimport { hexToBigInt, hexToNumber } from '../../utils/encoding/fromHex.js';\nimport { hexToBytes } from '../../utils/encoding/toBytes.js';\nimport { toHex } from '../../utils/encoding/toHex.js';\nimport { defineBlock } from '../../utils/formatters/block.js';\nimport { formatLog } from '../../utils/formatters/log.js';\nimport { defineTransaction } from '../../utils/formatters/transaction.js';\nimport { defineTransactionReceipt } from '../../utils/formatters/transactionReceipt.js';\nimport { defineTransactionRequest } from '../../utils/formatters/transactionRequest.js';\nexport const formattersZkSync = {\n  block: /*#__PURE__*/defineBlock({\n    format(args) {\n      const transactions = args.transactions?.map(transaction => {\n        if (typeof transaction === 'string') return transaction;\n        const formatted = formattersZkSync.transaction.format(transaction);\n        if (formatted.typeHex === '0x71') formatted.type = 'eip712';else if (formatted.typeHex === '0xff') formatted.type = 'priority';\n        return formatted;\n      });\n      return {\n        l1BatchNumber: args.l1BatchNumber ? hexToBigInt(args.l1BatchNumber) : null,\n        l1BatchTimestamp: args.l1BatchTimestamp ? hexToBigInt(args.l1BatchTimestamp) : null,\n        transactions\n      };\n    }\n  }),\n  transaction: /*#__PURE__*/defineTransaction({\n    format(args) {\n      const transaction = {};\n      if (args.type === '0x71') transaction.type = 'eip712';else if (args.type === '0xff') transaction.type = 'priority';\n      return {\n        ...transaction,\n        l1BatchNumber: args.l1BatchNumber ? hexToBigInt(args.l1BatchNumber) : null,\n        l1BatchTxIndex: args.l1BatchTxIndex ? hexToBigInt(args.l1BatchTxIndex) : null\n      };\n    }\n  }),\n  transactionReceipt: /*#__PURE__*/defineTransactionReceipt({\n    format(args) {\n      return {\n        l1BatchNumber: args.l1BatchNumber ? hexToBigInt(args.l1BatchNumber) : null,\n        l1BatchTxIndex: args.l1BatchTxIndex ? hexToBigInt(args.l1BatchTxIndex) : null,\n        logs: args.logs.map(log => {\n          return {\n            ...formatLog(log),\n            l1BatchNumber: log.l1BatchNumber ? hexToBigInt(log.l1BatchNumber) : null,\n            transactionLogIndex: hexToNumber(log.transactionLogIndex),\n            logType: log.logType\n          };\n        }),\n        l2ToL1Logs: args.l2ToL1Logs.map(l2ToL1Log => {\n          return {\n            blockNumber: hexToBigInt(l2ToL1Log.blockHash),\n            blockHash: l2ToL1Log.blockHash,\n            l1BatchNumber: hexToBigInt(l2ToL1Log.l1BatchNumber),\n            transactionIndex: hexToBigInt(l2ToL1Log.transactionIndex),\n            shardId: hexToBigInt(l2ToL1Log.shardId),\n            isService: l2ToL1Log.isService,\n            sender: l2ToL1Log.sender,\n            key: l2ToL1Log.key,\n            value: l2ToL1Log.value,\n            transactionHash: l2ToL1Log.transactionHash,\n            logIndex: hexToBigInt(l2ToL1Log.logIndex)\n          };\n        })\n      };\n    }\n  }),\n  transactionRequest: /*#__PURE__*/defineTransactionRequest({\n    exclude: ['customSignature', 'factoryDeps', 'gasPerPubdata', 'paymaster', 'paymasterInput'],\n    format(args) {\n      if (args.gasPerPubdata || args.paymaster && args.paymasterInput || args.factoryDeps || args.customSignature) return {\n        eip712Meta: {\n          ...(args.gasPerPubdata ? {\n            gasPerPubdata: toHex(args.gasPerPubdata)\n          } : {}),\n          ...(args.paymaster && args.paymasterInput ? {\n            paymasterParams: {\n              paymaster: args.paymaster,\n              paymasterInput: Array.from(hexToBytes(args.paymasterInput))\n            }\n          } : {}),\n          ...(args.factoryDeps ? {\n            factoryDeps: args.factoryDeps\n          } : {}),\n          ...(args.customSignature ? {\n            customSignature: args.customSignature\n          } : {})\n        },\n        type: args.type === 'eip712' ? '0x71' : '0xff'\n      };\n      return {};\n    }\n  })\n};","map":{"version":3,"names":["hexToBigInt","hexToNumber","hexToBytes","toHex","defineBlock","formatLog","defineTransaction","defineTransactionReceipt","defineTransactionRequest","formattersZkSync","block","format","args","transactions","map","transaction","formatted","typeHex","type","l1BatchNumber","l1BatchTimestamp","l1BatchTxIndex","transactionReceipt","logs","log","transactionLogIndex","logType","l2ToL1Logs","l2ToL1Log","blockNumber","blockHash","transactionIndex","shardId","isService","sender","key","value","transactionHash","logIndex","transactionRequest","exclude","gasPerPubdata","paymaster","paymasterInput","factoryDeps","customSignature","eip712Meta","paymasterParams","Array","from"],"sources":["/home/adib-alpha/projects/ethereum-app/node_modules/viem/chains/zksync/formatters.ts"],"sourcesContent":["import { type ChainFormatters } from '../../types/chain.js'\nimport type { Hash } from '../../types/misc.js'\nimport { hexToBigInt, hexToNumber } from '../../utils/encoding/fromHex.js'\nimport { hexToBytes } from '../../utils/encoding/toBytes.js'\nimport { toHex } from '../../utils/encoding/toHex.js'\nimport { defineBlock } from '../../utils/formatters/block.js'\nimport { formatLog } from '../../utils/formatters/log.js'\nimport { defineTransaction } from '../../utils/formatters/transaction.js'\nimport { defineTransactionReceipt } from '../../utils/formatters/transactionReceipt.js'\nimport { defineTransactionRequest } from '../../utils/formatters/transactionRequest.js'\nimport type {\n  ZkSyncBlockOverrides,\n  ZkSyncL2ToL1Log,\n  ZkSyncLog,\n  ZkSyncRpcBlockOverrides,\n  ZkSyncRpcTransaction,\n  ZkSyncRpcTransactionReceiptOverrides,\n  ZkSyncRpcTransactionRequest,\n  ZkSyncTransaction,\n  ZkSyncTransactionReceipt,\n  ZkSyncTransactionRequest,\n} from './types.js'\n\nexport const formattersZkSync = {\n  block: /*#__PURE__*/ defineBlock({\n    format(\n      args: ZkSyncRpcBlockOverrides & {\n        transactions: Hash[] | ZkSyncRpcTransaction[]\n      },\n    ): ZkSyncBlockOverrides & {\n      transactions: Hash[] | ZkSyncTransaction[]\n    } {\n      const transactions = args.transactions?.map((transaction) => {\n        if (typeof transaction === 'string') return transaction\n        const formatted = formattersZkSync.transaction.format(\n          transaction as ZkSyncRpcTransaction,\n        ) as ZkSyncTransaction\n        if (formatted.typeHex === '0x71') formatted.type = 'eip712'\n        else if (formatted.typeHex === '0xff') formatted.type = 'priority'\n        return formatted\n      }) as Hash[] | ZkSyncTransaction[]\n      return {\n        l1BatchNumber: args.l1BatchNumber\n          ? hexToBigInt(args.l1BatchNumber)\n          : null,\n        l1BatchTimestamp: args.l1BatchTimestamp\n          ? hexToBigInt(args.l1BatchTimestamp)\n          : null,\n        transactions,\n      }\n    },\n  }),\n  transaction: /*#__PURE__*/ defineTransaction({\n    format(args: ZkSyncRpcTransaction): ZkSyncTransaction {\n      const transaction = {} as ZkSyncTransaction\n      if (args.type === '0x71') transaction.type = 'eip712'\n      else if (args.type === '0xff') transaction.type = 'priority'\n      return {\n        ...transaction,\n        l1BatchNumber: args.l1BatchNumber\n          ? hexToBigInt(args.l1BatchNumber)\n          : null,\n        l1BatchTxIndex: args.l1BatchTxIndex\n          ? hexToBigInt(args.l1BatchTxIndex)\n          : null,\n      } as ZkSyncTransaction\n    },\n  }),\n  transactionReceipt: /*#__PURE__*/ defineTransactionReceipt({\n    format(\n      args: ZkSyncRpcTransactionReceiptOverrides,\n    ): ZkSyncTransactionReceipt {\n      return {\n        l1BatchNumber: args.l1BatchNumber\n          ? hexToBigInt(args.l1BatchNumber)\n          : null,\n        l1BatchTxIndex: args.l1BatchTxIndex\n          ? hexToBigInt(args.l1BatchTxIndex)\n          : null,\n        logs: args.logs.map((log) => {\n          return {\n            ...formatLog(log),\n            l1BatchNumber: log.l1BatchNumber\n              ? hexToBigInt(log.l1BatchNumber)\n              : null,\n            transactionLogIndex: hexToNumber(log.transactionLogIndex),\n            logType: log.logType,\n          }\n        }) as ZkSyncLog[],\n        l2ToL1Logs: args.l2ToL1Logs.map((l2ToL1Log) => {\n          return {\n            blockNumber: hexToBigInt(l2ToL1Log.blockHash),\n            blockHash: l2ToL1Log.blockHash,\n            l1BatchNumber: hexToBigInt(l2ToL1Log.l1BatchNumber),\n            transactionIndex: hexToBigInt(l2ToL1Log.transactionIndex),\n            shardId: hexToBigInt(l2ToL1Log.shardId),\n            isService: l2ToL1Log.isService,\n            sender: l2ToL1Log.sender,\n            key: l2ToL1Log.key,\n            value: l2ToL1Log.value,\n            transactionHash: l2ToL1Log.transactionHash,\n            logIndex: hexToBigInt(l2ToL1Log.logIndex),\n          }\n        }) as ZkSyncL2ToL1Log[],\n      } as ZkSyncTransactionReceipt\n    },\n  }),\n  transactionRequest: /*#__PURE__*/ defineTransactionRequest({\n    exclude: [\n      'customSignature',\n      'factoryDeps',\n      'gasPerPubdata',\n      'paymaster',\n      'paymasterInput',\n    ],\n    format(args: ZkSyncTransactionRequest): ZkSyncRpcTransactionRequest {\n      if (\n        args.gasPerPubdata ||\n        (args.paymaster && args.paymasterInput) ||\n        args.factoryDeps ||\n        args.customSignature\n      )\n        return {\n          eip712Meta: {\n            ...(args.gasPerPubdata\n              ? { gasPerPubdata: toHex(args.gasPerPubdata) }\n              : {}),\n            ...(args.paymaster && args.paymasterInput\n              ? {\n                  paymasterParams: {\n                    paymaster: args.paymaster,\n                    paymasterInput: Array.from(hexToBytes(args.paymasterInput)),\n                  },\n                }\n              : {}),\n            ...(args.factoryDeps ? { factoryDeps: args.factoryDeps } : {}),\n            ...(args.customSignature\n              ? { customSignature: args.customSignature }\n              : {}),\n          },\n          type: args.type === 'eip712' ? '0x71' : '0xff',\n        } as ZkSyncRpcTransactionRequest\n      return {} as ZkSyncRpcTransactionRequest\n    },\n  }),\n} as const satisfies ChainFormatters\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}